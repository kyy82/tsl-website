<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linear Regression</title>
    <script src="../scripts/mathjax-config.js"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="../scripts/demotab.css">
    <link rel="stylesheet" href="../demo-common.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="iframe-content">
        <div class="container">

        <div class="info-tabs">
            <div class="tab-header">
            </div>

            <div class="tab-content">
                <div class="tab-panel active" data-tab-title="Introduction">
                    This interactive demo helps you understand linear regression, one of the fundamental concepts in machine learning and statistics. Linear regression finds the best straight line through data points to model relationships between variables.<br><br>
                    You'll explore how changing the line parameters affects the fit quality, learn about different error metrics, and work with real civil engineering datasets to see linear regression in action.
                </div>

                <div class="tab-panel" data-tab-title="Instructions">
                    ‚Ä¢ Adjust the $\alpha$ (intercept) and $\beta$ (slope) sliders to move the regression line and observe how the error metrics change<br>
                    ‚Ä¢ Load sample datasets from civil engineering examples or generate/add your own data points by clicking on the plot<br>
                    ‚Ä¢ Toggle visualization options to explore squared errors and confidence intervals<br><br>

                    <strong>What is the maximum R¬≤ score you could achieve? Which sample dataset allows for the best fit? </strong>
                </div>


                <div class="tab-panel" data-tab-title="Compete">
                    <strong>Live Competition Mode</strong><br><br>
                    It's showtime! Your goal is to achieve the highest R¬≤ score in class using only manual parameter adjustment.<br><br>
                    <span style="color: darkred; font-weight: bold;">‚ö†Ô∏è Keep this tab active - switching to another tab may temporarily remove you from the leaderboard</span><br><br>


                    <strong>Competition Rules:</strong><br>

                    ‚Ä¢ Everyone uses the same randomly generated dataset<br>
                    ‚Ä¢ Only manual slider adjustment allowed - no "Find Optimal Solution" button<br>
                    ‚Ä¢ Real-time leaderboard shows top performers<br>
                    <div id="username-display" style="display: none;">‚Ä¢ Your anonymous name: <span id="competition-username" style="font-weight: bold; color: #3498db;"></span><br></div>
                    <br><strong>Scoring:</strong><br>
                    ‚Ä¢ Primary ranking by R¬≤ score (higher is better)<br>
                    ‚Ä¢ Secondary ranking by MSE (lower is better)<br>
                    ‚Ä¢ Live updates as you adjust parameters
                </div>

            </div>
        </div>

        <div class="demo-area">
            <div class="plot-container">
                <div style="position: relative; width: 600px; height: 455px;">
                    <canvas id="plot"></canvas>
                    <canvas id="overlay-canvas" style="position: absolute; top: 0; left: 0; pointer-events: none; background: transparent; z-index: 1; visibility: hidden;"></canvas>
                </div>
                <div class="plot-buttons">
                    <button class="generate-data-btn" id="generate-data-btn">Generate Random Data</button>
                    <button class="clear-data-btn" id="clear-data-btn">Clear All Data</button>
                </div>

                <!-- Competition Leaderboard Panel - positioned immediately below graph -->
                <div class="leaderboard-panel" id="leaderboard-panel" style="display: none;">
                    <div class="panel-title">üèÜ Live Competition Leaderboard - Top 10</div>
                    <div class="leaderboard-status" id="leaderboard-status">
                        <span class="status-indicator" id="status-dot"></span>
                        <span id="status-text">Connecting...</span>
                    </div>
                    <div class="leaderboard-content" id="leaderboard-content">
                        <div class="your-position" id="your-position"></div>
                        <div class="leaderboard-list" id="leaderboard-list"></div>
                    </div>
                </div>

                <div class="dataset-buttons-section">
                    <label class="dataset-section-label">Sample Datasets:</label>
                    <div class="dataset-buttons">
                        <button class="dataset-btn structures-btn" id="structures-btn">Structures</button>
                        <button class="dataset-btn geotech-btn" id="geotech-btn">Geotechnics</button>
                        <button class="dataset-btn transport-btn" id="transport-btn">Transport</button>
                        <button class="dataset-btn environment-btn" id="environment-btn">Environment</button>
                    </div>

                    <div class="dataset-info-box" id="dataset-info-box">
                        <div class="dataset-info-title" id="dataset-info-title"></div>
                        <div class="dataset-info-description" id="dataset-info-description"></div>
                        <div class="dataset-info-variables" id="dataset-info-variables"></div>
                    </div>
                </div>
            </div>

            <div class="controls">
                <div class="control-group">
                    <div class="label-with-buttons">
                        <label for="alpha">$\alpha$ (Intercept)</label>
                        <div class="fine-tune-buttons">
                            <button class="fine-tune-btn" id="alpha-minus">‚àí</button>
                            <button class="fine-tune-btn" id="alpha-plus">+</button>
                        </div>
                    </div>
                    <div class="slider-container">
                        <input type="range" id="alpha" min="-100" max="200" step="0.1" value="0">
                        <div class="value-display" id="alpha-value">0</div>
                    </div>
                </div>

                <div class="control-group">
                    <div class="label-with-buttons">
                        <label for="beta">$\beta$ (Gradient/Slope)</label>
                        <div class="fine-tune-buttons">
                            <button class="fine-tune-btn" id="beta-minus">‚àí</button>
                            <button class="fine-tune-btn" id="beta-plus">+</button>
                        </div>
                    </div>
                    <div class="slider-container">
                        <input type="range" id="beta" min="-10" max="30" step="0.01" value="1">
                        <div class="value-display" id="beta-value">1.0</div>
                    </div>
                </div>

                <div class="equation" id="equation">
                    y = 1.0x + 0
                </div>

                <div class="equation mae-equation" id="mae">
                    MAE = 0.0
                </div>

                <div class="equation mse-equation" id="mse">
                    MSE = 0.0
                </div>

                <div class="equation r2-equation" id="r2">
                    R¬≤ = 0.0
                </div>

                <div class="visualization-panel">
                    <div class="panel-title">Visualization Options</div>
                    <div class="checkbox-grid">
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-squares" class="checkbox-input">
                            Show Squared Errors
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-confidence" class="checkbox-input">
                            Show Confidence Intervals
                        </label>
                    </div>
                </div>

                <button class="solution-btn" id="solution-btn">Find Optimal Solution</button>
            </div>
        </div>

        <!-- Theory Section -->
        <div class="theory-section">
            <h3>Mathematical Foundations</h3>
            <p>
                The simplest regression model assumes a linear relationship between a single input feature and the output, taking the form $\hat{y} = \alpha + \beta x$, where $\hat{y}$ is our predicted value, $x$ is the input feature, $\alpha$ is the <em>bias</em> or <em>intercept</em> (the predicted value when $x=0$), and $\beta$ is the <em>weight</em> or <em>slope</em> (how much the prediction changes per unit of $x$).<br><br>

                <strong>Training the model</strong> means finding the best-fitting $\alpha$ and $\beta$ based on our training data. Visually, we want a line that goes close to all the points. Numerically, "best fit" usually means the line that minimizes the prediction errors. 

                We evaluate model performance using three complementary metrics, each highlighting different aspects of prediction quality:<br><br>

                <strong>1. Mean Absolute Error (MAE)</strong> = $\frac{1}{n}\sum_{i=1}^{n}|y_i - \hat{y}_i|$ measures the average absolute difference between actual and predicted values. MAE is <em>robust to outliers</em> because it treats all errors equally regardless of magnitude. Used when you want an intuitive measure in the same units as your data (e.g., if predicting bridge deflection in mm, MAE is also in mm). Lower values indicate better fit.<br><br>

                <strong>2. Mean Squared Error (MSE)</strong> = $\frac{1}{n}\sum_{i=1}^{n}(y_i - \hat{y}_i)^2$ measures the average squared difference between actual and predicted values. MSE <em>heavily penalizes large errors</em> due to squaring, making it sensitive to outliers. This is the most commonly used metric for training regression models because squaring makes the function differentiable everywhere and convex, enabling efficient optimization. The cost function $J(\alpha,\beta)$ used in training is essentially $\frac{1}{2}$MSE. Lower values indicate better fit.<br><br>

                <strong>3. R-squared (R¬≤)</strong> = $1 - \frac{\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}{\sum_{i=1}^{n}(y_i - \bar{y})^2}$ represents the proportion of variance in the data explained by the model, where $\bar{y}$ is the mean of observed values. R¬≤ ranges from 0 to 1 (or negative for very poor fits), with <em>higher values indicating better explanatory power</em>. Interpretation: 0.0-0.3 (poor fit), 0.3-0.7 (moderate), 0.7+ (good fit). Unlike MAE and MSE, R¬≤ is <em>scale-independent</em>, making it ideal for comparing models across different datasets or units. Widely used in statistics and sciences to communicate model quality to non-technical audiences.<br><br>

                <strong>Practical guidance:</strong> Use MSE for training (optimization-friendly), MAE for interpretable error reporting (same units as data), and R¬≤ for overall model assessment (percentage of variance explained). Confidence intervals show uncertainty in predictions‚Äîwider intervals indicate less certainty.
            </p>
        </div>

        <p style="font-style: italic; text-align: right; margin-top: 10px; color: #666; font-size: 14px;">
            Developed by <a href="https://transport-systems.imperial.ac.uk/members/qu-k" target="_blank" style="color: #666; text-decoration: underline;">Kevin Yu</a> & <a href="https://transport-systems.imperial.ac.uk/members/angeloudis-p" target="_blank" style="color: #666; text-decoration: underline;">Panagiotis Angeloudis</a>
        </p>

    </div>
    </div>

    <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
    <script src="../leaderboard-client.js"></script>
    <script src="../scripts/demotab.js"></script>
    <script src="script.js"></script>
</body>
</html>